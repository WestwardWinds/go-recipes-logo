{
  "version": 3,
  "sources": ["../../js/spice.js"],
  "sourcesContent": ["// strike out text\nfunction strike(el) {\n  el.classList.toggle(\"strike\");\n}\n\nwindow.strike = strike;\n\n// image preview\nfunction setImageSrc(el, imgID, fallback) {\n  const img = document.getElementById(imgID);\n  const [file] = el.files;\n  if (file) {\n    img.src = URL.createObjectURL(file);\n  } else {\n    img.src = fallback;\n  }\n}\n\nwindow.setImageSrc = setImageSrc;\n\n// focus search\nfunction slashToFocus(el) {\n  window.addEventListener(\"keydown\", (e) => {\n    if (document.activeElement === el) return;\n    if (e.code === \"Slash\") {\n      el.focus();\n      e.preventDefault();\n    }\n  });\n}\n\nwindow.slashToFocus = slashToFocus;\n\n// auto search limit size\nfunction setSearchLimit() {\n  let el = document.getElementById(\"search-results\");\n  if (el === null) return;\n  let name = \"search_limit\";\n  let value = Math.max(Math.floor(Math.min(1320, el.offsetWidth) / 200), 2) * 5;\n  let expiry = new Date();\n  let domain = window.location.hostname;\n  expiry.setMonth(expiry.getMonth() + 2);\n  let cookie = `${name}=${value};expires=${expiry};domain=${domain};path=/`;\n  document.cookie = cookie;\n}\n\nwindow.onload = function () {\n  if (!navigator.cookieEnabled) return;\n  const urlSearchParams = new URLSearchParams(window.location.search);\n  const params = Object.fromEntries(urlSearchParams.entries());\n  let el = document.getElementById(\"limit\");\n  if (\"limit\" in params) {\n    el.value = params.limit;\n  } else {\n    if (document.cookie.match(/^(.*;)?\\s*search_limit\\s*=\\s*[^;]+(.*)?$/)) {\n      el.value = \"auto\";\n    }\n  }\n\n  setSearchLimit();\n};\n\nif (navigator.cookieEnabled) {\n  window.onresize = setSearchLimit;\n}\n\n// nice\nif (\"scrollRestoration\" in history) {\n  history.scrollRestoration = \"auto\";\n}\n\n// scroll sync\nfunction syncSrolls(_tx, _rx) {\n  const tx = document.querySelector(_tx);\n  const rx = document.querySelector(_rx);\n\n  let hovered = false;\n  let offset = 0;\n  let scrollOfset = 0;\n  const sync = () => {\n    // only apply if below certain width\n    if (window.innerWidth < 480) {\n      offset = 0;\n      scrollOfset = 0;\n      return;\n    }\n\n    // compute max\n    let max = tx.offsetHeight - rx.offsetHeight;\n    max = Math.max(0, max);\n\n    // sticky scroll\n    let rxb = rx.getBoundingClientRect();\n    if (hovered) {\n      scrollOfset = Math.min(rxb.top, 0);\n    }\n\n    // reset sticky scroll\n    if (rxb.top > 0) {\n      scrollOfset = 0;\n    }\n\n    // no need to move\n    if (offset < 0 && rx.style.marginTop == \"0px\") {\n      return;\n    }\n\n    offset = tx.getBoundingClientRect().top * -1 + scrollOfset;\n    offset = Math.max(0, offset);\n    offset = Math.min(offset, max);\n    rx.style.marginTop = offset + \"px\";\n  };\n\n  rx.addEventListener(\"mouseenter\", (_) => {\n    hovered = true;\n  });\n\n  rx.addEventListener(\"mouseleave\", (_) => {\n    hovered = false;\n  });\n\n  window.addEventListener(\"scroll\", (_) => {\n    window.requestAnimationFrame(sync);\n  });\n}\n\nwindow.syncSrolls = syncSrolls;\n"],
  "mappings": "MACA,WAAgB,EAAI,CAClB,EAAG,UAAU,OAAO,QAAQ,CAC9B,CAEA,OAAO,OAAS,EAGhB,WAAqB,EAAI,EAAO,EAAU,CACxC,GAAM,GAAM,SAAS,eAAe,CAAK,EACnC,CAAC,GAAQ,EAAG,MAClB,AAAI,EACF,EAAI,IAAM,IAAI,gBAAgB,CAAI,EAElC,EAAI,IAAM,CAEd,CAEA,OAAO,YAAc,EAGrB,WAAsB,EAAI,CACxB,OAAO,iBAAiB,UAAW,AAAC,GAAM,CACxC,AAAI,SAAS,gBAAkB,GAC3B,EAAE,OAAS,SACb,GAAG,MAAM,EACT,EAAE,eAAe,EAErB,CAAC,CACH,CAEA,OAAO,aAAe,EAGtB,YAA0B,CACxB,GAAI,GAAK,SAAS,eAAe,gBAAgB,EACjD,GAAI,IAAO,KAAM,OACjB,GAAI,GAAO,eACP,EAAQ,KAAK,IAAI,KAAK,MAAM,KAAK,IAAI,KAAM,EAAG,WAAW,EAAI,GAAG,EAAG,CAAC,EAAI,EACxE,EAAS,GAAI,MACb,EAAS,OAAO,SAAS,SAC7B,EAAO,SAAS,EAAO,SAAS,EAAI,CAAC,EACrC,GAAI,GAAS,GAAG,KAAQ,aAAiB,YAAiB,WAC1D,SAAS,OAAS,CACpB,CAEA,OAAO,OAAS,UAAY,CAC1B,GAAI,CAAC,UAAU,cAAe,OAC9B,GAAM,GAAkB,GAAI,iBAAgB,OAAO,SAAS,MAAM,EAC5D,EAAS,OAAO,YAAY,EAAgB,QAAQ,CAAC,EACvD,EAAK,SAAS,eAAe,OAAO,EACxC,AAAI,SAAW,GACb,EAAG,MAAQ,EAAO,MAEd,SAAS,OAAO,MAAM,0CAA0C,GAClE,GAAG,MAAQ,QAIf,EAAe,CACjB,EAEA,AAAI,UAAU,eACZ,QAAO,SAAW,GAIpB,AAAI,qBAAuB,UACzB,SAAQ,kBAAoB,QAI9B,WAAoB,EAAK,EAAK,CAC5B,GAAM,GAAK,SAAS,cAAc,CAAG,EAC/B,EAAK,SAAS,cAAc,CAAG,EAEjC,EAAU,GACV,EAAS,EACT,EAAc,EACZ,EAAO,IAAM,CAEjB,GAAI,OAAO,WAAa,IAAK,CAC3B,EAAS,EACT,EAAc,EACd,MACF,CAGA,GAAI,GAAM,EAAG,aAAe,EAAG,aAC/B,EAAM,KAAK,IAAI,EAAG,CAAG,EAGrB,GAAI,GAAM,EAAG,sBAAsB,EAWnC,AAVI,GACF,GAAc,KAAK,IAAI,EAAI,IAAK,CAAC,GAI/B,EAAI,IAAM,GACZ,GAAc,GAIZ,IAAS,GAAK,EAAG,MAAM,WAAa,QAIxC,GAAS,EAAG,sBAAsB,EAAE,IAAM,GAAK,EAC/C,EAAS,KAAK,IAAI,EAAG,CAAM,EAC3B,EAAS,KAAK,IAAI,EAAQ,CAAG,EAC7B,EAAG,MAAM,UAAY,EAAS,KAChC,EAEA,EAAG,iBAAiB,aAAc,AAAC,GAAM,CACvC,EAAU,EACZ,CAAC,EAED,EAAG,iBAAiB,aAAc,AAAC,GAAM,CACvC,EAAU,EACZ,CAAC,EAED,OAAO,iBAAiB,SAAU,AAAC,GAAM,CACvC,OAAO,sBAAsB,CAAI,CACnC,CAAC,CACH,CAEA,OAAO,WAAa",
  "names": []
}
